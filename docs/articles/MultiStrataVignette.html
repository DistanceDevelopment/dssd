<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="dssd">
<title>Multiple Strata in dssd â€¢ dssd</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Multiple Strata in dssd">
<meta property="og:description" content="dssd">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">dssd</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/GettingStarted.html">Getting Started with dssd</a>
    <a class="dropdown-item" href="../articles/MultiStrataVignette.html">Multiple Strata in dssd</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/distancesamp" aria-label="Twitter">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/DistanceDevelopment/dssd/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Multiple Strata in dssd</h1>
                        <h4 data-toc-skip class="author">L.
Marshall</h4>
            <address class="author_afil">
      CREEM, Univ of St Andrews<br><h4 data-toc-skip class="date">May 2024</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/DistanceDevelopment/dssd/blob/HEAD/vignettes/MultiStrataVignette.Rmd" class="external-link"><code>vignettes/MultiStrataVignette.Rmd</code></a></small>
      <div class="d-none name"><code>MultiStrataVignette.Rmd</code></div>
    </address>
</div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The most up-to-date copies of these vignettes can now be found on the
distance sampling examples page of our website: <a href="https://examples.distancesampling.org" class="external-link uri">https://examples.distancesampling.org</a></p>
<p>This vignette assumes the reader is familiar with the topics covered
in the getting started vignette. It expands on that content,
demonstrating how to use the distance sampling survey design package,
dssd <span class="citation">(Marshall 2019)</span> when your study
region is made up of multiple strata. This vignette will detail how you
can select different designs (within the same design category, either
lines or points) for each stratum and provide stratum specific design
parameters. Please note that the examples provided in this vignette are
designed to make the reader aware of what is possible inside the dssd
package and the designs are not necessarily something that we would
recommended for these example survey regions.</p>
</div>
<div class="section level2">
<h2 id="stratified-designs---why-stratify">Stratified Designs - why stratify?<a class="anchor" aria-label="anchor" href="#stratified-designs---why-stratify"></a>
</h2>
<p>There are a number of reasons that we may wish to create a stratified
design. Firstly, it may be for efficiency reasons. For example, we may
wish to divide our region into a number of more convex shapes when using
an equal spaced zigzag design to reduce off-effort transit time at the
survey region boundary. Figure 1 presents an example of a Minke whale
survey, in the left panel when the zigzag design is generated in the
study region as a whole we can see that it is fairly inefficient with
large distances between the ends of transects (note that only the
lengths of transect inside the shaded study area will be surveyed). In
the right panel we have reduced the off effort transit time by dividing
the study area into a number of strata. As the purpose of this
stratification is simply to improve efficiency we would still want to
try to achieve equal coverage across all strata.</p>
<div class="float">
<img src="images/efficiencystrats.png" alt="Figure 1: Example survey design for a Minke whale survey. The shaded polygons represent the study area and the dotted lines represent convex hulls stretched around the study region polygons. While the full length of the zigzag transects is shown only the parts inside the shaded area will be surveyed. Left panel shows an equal spaced zigzag design generated inside a convex hull applied to the study region as a whole. The right panel shows an equal spaced zigzag design generated inside a number of strata selected so that the study region was divided into a number of almost convex shapes."><div class="figcaption">Figure 1: Example survey design for a Minke
whale survey. The shaded polygons represent the study area and the
dotted lines represent convex hulls stretched around the study region
polygons. While the full length of the zigzag transects is shown only
the parts inside the shaded area will be surveyed. Left panel shows an
equal spaced zigzag design generated inside a convex hull applied to the
study region as a whole. The right panel shows an equal spaced zigzag
design generated inside a number of strata selected so that the study
region was divided into a number of almost convex shapes.</div>
</div>
<p>Another reason some people consider stratifying their survey region
is to improve precision. More precise estimates of density / abundance
can sometimes be achieved by allocating more effort to areas of high
density and less effort to areas of low density. This allows
inter-stratum differences to be estimated rather than have them
contribute to the variance of the estimates. Certainly, if there are
large areas where you expect to see very little it might be unwise to
spend a lot of expensive resources in these areas. However, there are
dangers of unequal effort allocation (otherwise called non-uniform
coverage). There may be differences in encounter rate, detection
function or mean cluster size across the different strata. If any of
these are estimated by pooling across strata when in fact they differ
between strata then within stratum estimates will be biased and the
global estimates may also be biased. The only way to be sure if
inter-stratum differences exist is to ensure that you have sufficient
data in each strata to estimate the encounter rate, detection function
and mean cluster size by stratum. Otherwise you will need to rely on
making biological assumptions.</p>
<p>A third scenario in which you may want to stratify is that you wish
to make inference about a particular sub-region of your study area. In
addition, if you plan on fitting a spatial model to your distance
sampling data you may have regions of particular interest in which you
would like to detect changes in density at smaller scales than in other
regions.</p>
<p>Finally you may wish to stratify as you plan to survey from two
different platforms, for example marine surveys when some strata will be
surveyed from a ship while others are surveyed from the air. Ship-board
surveys often use zigzag designs for efficiency to maximise on-effort
survey time. Ships have sufficient space for multiple sets of observers
so ship board surveys can achieve continuous observation while
travelling along the transects. In contrast, aerial surveys often use
systematic parallel line designs. Firstly the tight turns at the end of
zigzags can be hard to achieve in an airplane (and unpleasant for the
crew) and secondly the time taken to transit between parallel transects
can be useful periods of rest for a single set of observers. The Small
Cetaceans in the European Atlantic and North Sea II (SCANS II) strata
were designed to implement this mixed platform approach.</p>
</div>
<div class="section level2">
<h2 id="multi-strata-designs-using-dssd">Multi-Strata Designs using dssd<a class="anchor" aria-label="anchor" href="#multi-strata-designs-using-dssd"></a>
</h2>
<div class="section level3">
<h3 id="equal-effort-designs">Equal Effort Designs<a class="anchor" aria-label="anchor" href="#equal-effort-designs"></a>
</h3>
<p>This survey design package assists with equal effort allocation
across strata by allowing input of a single value for either the number
of samplers or the length of the line to be shared out equally among
strata. When the design is systematic and the same design is used in
every strata then dssd can calculate the spacing value across all strata
at once and can ensure more even coverage. Alternatively, users can
input a single spacing value to be used in all strata. These strategies
lead to as equal effort as possible across the study region. There may
be small differences between strata depending on the design selected and
the exact shapes of the different strata. When designs vary across
strata or are not systematic then the spacing values or sampler numbers
must be calculated on a stratum by stratum basis and may lead to
slightly larger differences in coverage between strata, such differences
can be assessed inside dssd by running coverage simulations. It is
generally advisable to run coverage simulations for all potential
designs.</p>
</div>
<div class="section level3">
<h3 id="unequal-effort-designs">Unequal Effort Designs<a class="anchor" aria-label="anchor" href="#unequal-effort-designs"></a>
</h3>
<p>If you wish to implement an unequal effort design, then this can be
achieved in a number of ways inside dssd. The user can chose to
explicitly specify the number of samplers, line length or other design
parameter values for each stratum individually. Alternatively, the user
can specify a single value for number of samplers or line length and
allocate the effort to each stratum based on proportions. If the effort
allocation argument is not supplied then the default is that effort is
allocated based on stratum area giving approximately equal coverage
between strata. Alternatively, the user can instead specify the effort
allocation argument as a vector of proportions with one value per
stratum which sum to 1. Effort will then be allocated to strata based on
these proportions.</p>
</div>
</div>
<div class="section level2">
<h2 id="defining-the-study-area">Defining the Study Area<a class="anchor" aria-label="anchor" href="#defining-the-study-area"></a>
</h2>
<p>First we need to load the dssd library.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">dssd</span><span class="op">)</span></span></code></pre></div>
<p>The study area can be defined in the same way as for a single stratum
study region by providing a shapefile. This shapefile however will
contain multiple polygon features. The first example study region used
in this vignette is one of the Danish coastal strata from the SCANS II
survey, Figure 2. The coastline is the study region border along the
east of the study area. The study area had been divided into two strata
for the purposes of maximising samplers and keeping the samplers roughly
perpendicular to the coastline. For the design examples in this vignette
we will treat this strata as the entire study region and the parts as
separate strata. Note that the units for this shapefile are in metres so
all design arguments relating to distances must also be provided in
metres.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">shapefile.name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"Strata.shp"</span>, package <span class="op">=</span> <span class="st">"dssd"</span><span class="op">)</span></span>
<span><span class="va">region</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make.region.html">make.region</a></span><span class="op">(</span>region.name <span class="op">=</span> <span class="st">"study.area"</span>, </span>
<span>                      strata.name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"North"</span>, <span class="st">"South"</span><span class="op">)</span>,</span>
<span>                      shape <span class="op">=</span> <span class="va">shapefile.name</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">region</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="MultiStrataVignette_files/figure-html/scansIIarea-1.png" alt="Figure 2: Plot of an example study area comprising of 2 strata, a northern stratum and a southern stratum" width="576"><p class="caption">
Figure 2: Plot of an example study area comprising of 2 strata, a
northern stratum and a southern stratum
</p>
</div>
<p>Additional information on how to manually create multi-strata study
regions inside R can be found in the â€˜manual creation of study areasâ€™
appendix.</p>
<div style="page-break-after: always;"></div>
</div>
<div class="section level2">
<h2 id="creating-a-coverage-grid">Creating a Coverage Grid<a class="anchor" aria-label="anchor" href="#creating-a-coverage-grid"></a>
</h2>
<p>The coverage grid can be created in the same way as for a single
stratum study region. The creation of the coverage grid involves
creating a single grid of points over the entire study area and so is
unaffected by the region being subdivided into multiple strata, Figure
3.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cover</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make.coverage.html">make.coverage</a></span><span class="op">(</span><span class="va">region</span>,</span>
<span>                       n.grid.points <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">region</span>, <span class="va">cover</span>, cex <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="MultiStrataVignette_files/figure-html/covergrid-1.png" alt="Figure 3: Coverage grid with approximately 1000 grid points." width="576"><p class="caption">
Figure 3: Coverage grid with approximately 1000 grid points.
</p>
</div>
</div>
<div class="section level2">
<h2 id="defining-the-design">Defining the Design<a class="anchor" aria-label="anchor" href="#defining-the-design"></a>
</h2>
<p>This section will demonstrate a number of example designs to show how
design, design angle, effort, edge sampling and other design parameters
can be varied across strata.</p>
<div class="section level3">
<h3 id="default-design-with-specified-design-angles">Default Design (with specified design angles)<a class="anchor" aria-label="anchor" href="#default-design-with-specified-design-angles"></a>
</h3>
<p>Similar to single stratum regions, the default design for
multi-strata regions is 20 systematic parallel lines with a design angle
of 0 (i.e.Â the lines run perpendicular to the x-axis) and using a minus
sampling edge protocol. The spacing is selected at the global level to
achieve a total of approximately 20 lines across all strata. In this
first example, we will leave the default effort but specify design
angles which will mean that our parallel lines run roughly perpendicular
to the coastline. Our survey should therefore have around 20 lines which
have the same spacing in both the North and South strata. The default
design has a truncation distance of 1 which will rarely be applicable so
we have specified it here as 2000 m. A single survey generated from this
design is plotted in Figure 4.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">default.design</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make.design.html">make.design</a></span><span class="op">(</span>region <span class="op">=</span> <span class="va">region</span>,</span>
<span>                              transect.type <span class="op">=</span> <span class="st">"line"</span>,</span>
<span>                              design <span class="op">=</span> <span class="st">"systematic"</span>,</span>
<span>                              samplers <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                              design.angle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">155</span>, <span class="fl">90</span><span class="op">)</span>,</span>
<span>                              edge.protocol <span class="op">=</span> <span class="st">"minus"</span>,</span>
<span>                              truncation <span class="op">=</span> <span class="fl">2000</span>, </span>
<span>                              coverage.grid <span class="op">=</span> <span class="va">cover</span><span class="op">)</span></span>
<span><span class="va">transects</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate.transects-methods.html">generate.transects</a></span><span class="op">(</span><span class="va">default.design</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">region</span>, <span class="va">transects</span>, lwd <span class="op">=</span> <span class="fl">0.8</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="MultiStrataVignette_files/figure-html/defaultdesign-1.png" alt="Figure 4: Survey generated from on a multi-strata default design with stratum specific design angles. " width="576"><p class="caption">
Figure 4: Survey generated from on a multi-strata default design with
stratum specific design angles.
</p>
</div>
<p>We can also view a summary of the survey shown in Figure 4. The
output shown below tells us that dssd selected a spacing of around 17.9
km (17946.09 m) between the systematic parallel lines. As both strata
used the same systematic design the spacing values were calculated
globally and are identical for both strata. It also tells us that the
percentage of the study region covered was around 22% in both strata and
that for this particular survey we have achieved exactly 20 transects,
11 in the northern strata and 9 in the southern strata.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">transects</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##    Strata North:</span></span>
<span><span class="co">##    ______________</span></span>
<span><span class="co">## Design:  systematically spaced parallel transects</span></span>
<span><span class="co">## Spacing:  17946.09</span></span>
<span><span class="co">## Line length: 525341</span></span>
<span><span class="co">## Trackline length: 724166.8</span></span>
<span><span class="co">## Cyclic trackline length: 904116.6</span></span>
<span><span class="co">## Number of samplers:  11</span></span>
<span><span class="co">## Design angle:  155</span></span>
<span><span class="co">## Edge protocol:  minus</span></span>
<span><span class="co">## Covered area:  2083756793</span></span>
<span><span class="co">## Strata coverage: 22.45%</span></span>
<span><span class="co">## Strata area:  9280648398</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    Strata South:</span></span>
<span><span class="co">##    ______________</span></span>
<span><span class="co">## Design:  systematically spaced parallel transects</span></span>
<span><span class="co">## Spacing:  17946.09</span></span>
<span><span class="co">## Line length: 643553.8</span></span>
<span><span class="co">## Trackline length: 814796.6</span></span>
<span><span class="co">## Cyclic trackline length: 958365.9</span></span>
<span><span class="co">## Number of samplers:  9</span></span>
<span><span class="co">## Design angle:  90</span></span>
<span><span class="co">## Edge protocol:  minus</span></span>
<span><span class="co">## Covered area:  2563013876</span></span>
<span><span class="co">## Strata coverage: 21.88%</span></span>
<span><span class="co">## Strata area:  11716012130</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    Study Area Totals:</span></span>
<span><span class="co">##    _________________</span></span>
<span><span class="co">## Line length: 1168895</span></span>
<span><span class="co">## Trackline length: 1538963</span></span>
<span><span class="co">## Cyclic trackline length: 1862483</span></span>
<span><span class="co">## Number of samplers:  20</span></span>
<span><span class="co">## Covered area:  4646770669</span></span>
<span><span class="co">## Average coverage: 22.13%</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="vary-design-by-stratum">Vary design by stratum<a class="anchor" aria-label="anchor" href="#vary-design-by-stratum"></a>
</h3>
<p>Within the categories of line and point transect designs, different
types of design may be selected for each stratum. Here we will use an
equally spaced zigzag design in the northern stratum and a systematic
parallel line in the southern stratum. Note the design angle has a
different definition for zigzag designs than parallel line designs so
the first value has been modified to 65 degrees (at right angles to the
parallel line design above). To maximise the efficiency of the zigzag
design we will specify the bounding shape for this stratum as a convex
hull. Note that no bounding shape is used in the systematic parallel
line design so the second value for bounding shape argument is NA. This
design also explicitly declares the edge protocol as minus sampling,
which will be applied to both strata. The effort for this design is
supplied as a single line length and as we have not defined effort
allocation the total line length of 1200 km (1200000 m) will be shared
among the strata based on their areas. An example survey generated from
this design is shown in Figure 5.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make.design.html">make.design</a></span><span class="op">(</span>region <span class="op">=</span> <span class="va">region</span>,</span>
<span>                              transect.type <span class="op">=</span> <span class="st">"line"</span>,</span>
<span>                              design <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"eszigzag"</span>, <span class="st">"systematic"</span><span class="op">)</span>,</span>
<span>                              line.length <span class="op">=</span> <span class="fl">1200000</span>,</span>
<span>                              design.angle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">65</span>, <span class="fl">90</span><span class="op">)</span>,</span>
<span>                              bounding.shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"convex.hull"</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>                              edge.protocol <span class="op">=</span> <span class="st">"minus"</span>,</span>
<span>                              truncation <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>                              coverage.grid <span class="op">=</span> <span class="va">cover</span><span class="op">)</span></span>
<span><span class="va">transects</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate.transects-methods.html">generate.transects</a></span><span class="op">(</span><span class="va">design</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">region</span>, <span class="va">transects</span>, lwd <span class="op">=</span> <span class="fl">0.8</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="MultiStrataVignette_files/figure-html/zz_sp-1.png" alt="Figure 5: Example survey from a mixed-type design with systematic parallel lines in the southern strata and an equal spaced zigzag designs in the northern strata." width="576"><p class="caption">
Figure 5: Example survey from a mixed-type design with systematic
parallel lines in the southern strata and an equal spaced zigzag designs
in the northern strata.
</p>
</div>
<p>Let us now run a coverage check on this design to see if the coverage
is roughly the same in both strata. Looking at Figure 6 the coverage
probabilities look to be roughly the same on average for the two strata.
We do however see the sharp corners of the northern stratum displaying a
higher coverage due to the zigzag design being generated in a convex
hull.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run.coverage.html">run.coverage</a></span><span class="op">(</span><span class="va">design</span>, reps <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">design</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## old-style crs object detected; please recreate object with a recent sf::st_crs()</span></span>
<span><span class="co">## old-style crs object detected; please recreate object with a recent sf::st_crs()</span></span>
<span><span class="co">## old-style crs object detected; please recreate object with a recent sf::st_crs()</span></span></code></pre>
<div class="figure" style="text-align: center">
<img src="MultiStrataVignette_files/figure-html/zz_sp_cov-1.png" alt="Figure 6: A plot of the coverage scores for the mixed type design, based on the generation of 500 surveys from this design." width="480"><p class="caption">
Figure 6: A plot of the coverage scores for the mixed type design, based
on the generation of 500 surveys from this design.
</p>
</div>
<p>We can also look at the design statistics from the 1000 surveys
generated, displayed below. We can see in this multiple strata example
we are now given stratum-specific statistics as well as values for the
study region as a whole in the Total columns. We can see from the strata
areas information that the southern strata is slightly bigger than the
northern strata and also looking at the covered area table we see that
the covered area is larger in the southern strata. If we look at the %
of region covered statistics we see that the coverage is approximately
the same in both strata, having a percentage covered of 22.09% in the
northern stratum and 22.67% in the southern stratum.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">design</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##    Strata North:</span></span>
<span><span class="co">##    ______________</span></span>
<span><span class="co">## Design:  equal spaced zigzag</span></span>
<span><span class="co">## Spacing:  NA</span></span>
<span><span class="co">## Number of samplers:  NA</span></span>
<span><span class="co">## Line length:  1200000  (shared across strata)</span></span>
<span><span class="co">## Design angle:  65</span></span>
<span><span class="co">## Edge protocol:  minus</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    Strata South:</span></span>
<span><span class="co">##    ______________</span></span>
<span><span class="co">## Design:  systematically spaced transects</span></span>
<span><span class="co">## Spacing:  NA</span></span>
<span><span class="co">## Number of samplers:  NA</span></span>
<span><span class="co">## Line length:  1200000  (shared across strata)</span></span>
<span><span class="co">## Design angle:  90</span></span>
<span><span class="co">## Edge protocol:  minus</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Strata areas:  9280648398, 11716012130</span></span>
<span><span class="co">## Region and effort units:  m</span></span>
<span><span class="co">## Coverage Simulation repetitions:  1000</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Number of samplers:</span></span>
<span><span class="co">##     </span></span>
<span><span class="co">##         North South Total</span></span>
<span><span class="co">## Minimum   9.0   9.0  18.0</span></span>
<span><span class="co">## Mean     10.7   9.5  20.2</span></span>
<span><span class="co">## Median   11.0  10.0  20.0</span></span>
<span><span class="co">## Maximum  12.0  10.0  22.0</span></span>
<span><span class="co">## sd        0.6   0.5   0.8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Covered area:</span></span>
<span><span class="co">##     </span></span>
<span><span class="co">##              North      South      Total</span></span>
<span><span class="co">## Minimum 1955116049 2513421503 4481285619</span></span>
<span><span class="co">## Mean    2049652296 2656340209 4705992505</span></span>
<span><span class="co">## Median  2070366837 2670394472 4713693428</span></span>
<span><span class="co">## Maximum 2091766860 2782781204 4870589559</span></span>
<span><span class="co">## sd        36486449   82822551   91678794</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     % of region covered:</span></span>
<span><span class="co">##     </span></span>
<span><span class="co">##         North South Total</span></span>
<span><span class="co">## Minimum 21.07 21.45 21.34</span></span>
<span><span class="co">## Mean    22.09 22.67 22.41</span></span>
<span><span class="co">## Median  22.31 22.79 22.45</span></span>
<span><span class="co">## Maximum 22.54 23.75 23.20</span></span>
<span><span class="co">## sd       0.39  0.71  0.44</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Line length:</span></span>
<span><span class="co">##     </span></span>
<span><span class="co">##            North     South      Total</span></span>
<span><span class="co">## Minimum 497407.9 631156.05 1128751.83</span></span>
<span><span class="co">## Mean    521716.3 669307.22 1191023.50</span></span>
<span><span class="co">## Median  525731.8 670981.00 1192041.07</span></span>
<span><span class="co">## Maximum 535469.7 706157.31 1239785.11</span></span>
<span><span class="co">## sd        9013.4  23011.45   24965.31</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Trackline length:</span></span>
<span><span class="co">##     </span></span>
<span><span class="co">##             North     South      Total</span></span>
<span><span class="co">## Minimum 512691.24 798122.48 1311004.79</span></span>
<span><span class="co">## Mean    538759.40 846771.69 1385531.09</span></span>
<span><span class="co">## Median  541724.36 856097.28 1392394.59</span></span>
<span><span class="co">## Maximum 550794.04 891391.01 1440740.61</span></span>
<span><span class="co">## sd        8958.67  31339.93   32758.02</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Cyclic trackline length:</span></span>
<span><span class="co">##     </span></span>
<span><span class="co">##             North      South      Total</span></span>
<span><span class="co">## Minimum 683046.12  938100.75 1621340.14</span></span>
<span><span class="co">## Mean    722453.73 1005787.30 1728241.03</span></span>
<span><span class="co">## Median  727656.40 1031911.48 1741506.91</span></span>
<span><span class="co">## Maximum 737260.78 1066109.12 1801958.77</span></span>
<span><span class="co">## sd       13922.31   47925.48   50049.89</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Coverage Score Summary:</span></span>
<span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## old-style crs object detected; please recreate object with a recent sf::st_crs()</span></span>
<span><span class="co">## old-style crs object detected; please recreate object with a recent sf::st_crs()</span></span>
<span><span class="co">## old-style crs object detected; please recreate object with a recent sf::st_crs()</span></span>
<span><span class="co">## old-style crs object detected; please recreate object with a recent sf::st_crs()</span></span>
<span><span class="co">## old-style crs object detected; please recreate object with a recent sf::st_crs()</span></span>
<span><span class="co">## old-style crs object detected; please recreate object with a recent sf::st_crs()</span></span>
<span><span class="co">## old-style crs object detected; please recreate object with a recent sf::st_crs()</span></span>
<span><span class="co">## old-style crs object detected; please recreate object with a recent sf::st_crs()</span></span>
<span><span class="co">## old-style crs object detected; please recreate object with a recent sf::st_crs()</span></span>
<span><span class="co">## old-style crs object detected; please recreate object with a recent sf::st_crs()</span></span>
<span><span class="co">## old-style crs object detected; please recreate object with a recent sf::st_crs()</span></span>
<span><span class="co">## old-style crs object detected; please recreate object with a recent sf::st_crs()</span></span>
<span><span class="co">## old-style crs object detected; please recreate object with a recent sf::st_crs()</span></span>
<span><span class="co">## old-style crs object detected; please recreate object with a recent sf::st_crs()</span></span>
<span><span class="co">## old-style crs object detected; please recreate object with a recent sf::st_crs()</span></span>
<span><span class="co">## old-style crs object detected; please recreate object with a recent sf::st_crs()</span></span></code></pre>
<pre><code><span><span class="co">##             North      South      Total</span></span>
<span><span class="co">## Minimum 0.0870000 0.12000000 0.08700000</span></span>
<span><span class="co">## Mean    0.2201493 0.22586538 0.22337377</span></span>
<span><span class="co">## Median  0.2190000 0.22300000 0.22200000</span></span>
<span><span class="co">## Maximum 0.3910000 0.27000000 0.39100000</span></span>
<span><span class="co">## sd      0.0309947 0.02553877 0.02817631</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="segmented-line-design">Segmented Line Design<a class="anchor" aria-label="anchor" href="#segmented-line-design"></a>
</h3>
<p>This example uses a segmented grid design to further demonstrate how
design parameters can be varied across strata. In this example the
spacing, segment length and segment threshold values have been specified
explicitly for each strata. In the northern stratum we have segments of
5km in length separated by 10km. The segment threshold of 50 means that
any segments less than 50% of the segment length (i.e.Â 2.5km) will be
discarded. In the southern stratum we have segments of 12km separated by
20km and where we retain all segments no matter how short they are
(segment threshold of 0). An example survey from this design is shown in
Figure 7.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make.design.html">make.design</a></span><span class="op">(</span>region <span class="op">=</span> <span class="va">region</span>,</span>
<span>                      transect.type <span class="op">=</span> <span class="st">"line"</span>,</span>
<span>                      design <span class="op">=</span> <span class="st">"segmentedgrid"</span>,</span>
<span>                      spacing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10000</span>,<span class="fl">20000</span><span class="op">)</span>,</span>
<span>                      seg.length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5000</span>,<span class="fl">12000</span><span class="op">)</span>,</span>
<span>                      design.angle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">150</span>, <span class="fl">90</span><span class="op">)</span>,</span>
<span>                      seg.threshold <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>,<span class="fl">0</span><span class="op">)</span>, </span>
<span>                      edge.protocol <span class="op">=</span> <span class="st">"minus"</span>,</span>
<span>                      truncation <span class="op">=</span> <span class="fl">3000</span>,</span>
<span>                      coverage.grid <span class="op">=</span> <span class="va">cover</span><span class="op">)</span></span>
<span><span class="va">transects</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate.transects-methods.html">generate.transects</a></span><span class="op">(</span><span class="va">design</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">region</span>, <span class="va">transects</span>, lwd <span class="op">=</span> <span class="fl">0.8</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="MultiStrataVignette_files/figure-html/seg_design-1.png" alt="Figure 7: A single survey generated from a segmented grid design with different design parameters in each stratum." width="576"><p class="caption">
Figure 7: A single survey generated from a segmented grid design with
different design parameters in each stratum.
</p>
</div>
<p>We can then have a look at the coverage scores to examine coverage in
the two strata. We observe on average the coverage is higher in the
northern stratum than the southern stratum because spacing was half as
large in the northern stratum, Figure 8.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run.coverage.html">run.coverage</a></span><span class="op">(</span><span class="va">design</span>, reps <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">design</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## old-style crs object detected; please recreate object with a recent sf::st_crs()</span></span>
<span><span class="co">## old-style crs object detected; please recreate object with a recent sf::st_crs()</span></span>
<span><span class="co">## old-style crs object detected; please recreate object with a recent sf::st_crs()</span></span></code></pre>
<div class="figure" style="text-align: center">
<img src="MultiStrataVignette_files/figure-html/seg_design3-1.png" alt="Figure 8: Coverage scores plotted for the segmented grid design" width="480"><p class="caption">
Figure 8: Coverage scores plotted for the segmented grid design
</p>
</div>
<p>When there are differences in average coverage between strata it is
sometimes difficult to visualise non-uniform coverage within strata. The
survey design package also provides the functionality to view the
coverage score plot for individual strata, Figures 9 and 10. While the
minor edge effects in the northern stratum were apparent when the study
area was plotted as a whole, Figure 8, the edge effects in the southern
stratum were not detectable in this plot. However, we can see from
Figure 10 that the edge effects in the southern stratum are also very
small in comparison to the stratum area.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">design</span>, strata.id <span class="op">=</span> <span class="fl">1</span>, subtitle <span class="op">=</span> <span class="st">"Coverage Northern Strata"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## old-style crs object detected; please recreate object with a recent sf::st_crs()</span></span>
<span><span class="co">## old-style crs object detected; please recreate object with a recent sf::st_crs()</span></span>
<span><span class="co">## old-style crs object detected; please recreate object with a recent sf::st_crs()</span></span>
<span><span class="co">## old-style crs object detected; please recreate object with a recent sf::st_crs()</span></span>
<span><span class="co">## old-style crs object detected; please recreate object with a recent sf::st_crs()</span></span>
<span><span class="co">## old-style crs object detected; please recreate object with a recent sf::st_crs()</span></span>
<span><span class="co">## old-style crs object detected; please recreate object with a recent sf::st_crs()</span></span></code></pre>
<div class="figure" style="text-align: center">
<img src="MultiStrataVignette_files/figure-html/seg_design4-1.png" alt="Figure 9: Coverage scores plotted only for the northern stratum" width="432"><p class="caption">
Figure 9: Coverage scores plotted only for the northern stratum
</p>
</div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">design</span>, strata.id <span class="op">=</span> <span class="fl">2</span>, subtitle <span class="op">=</span> <span class="st">"Coverage Southern Strata"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## old-style crs object detected; please recreate object with a recent sf::st_crs()</span></span>
<span><span class="co">## old-style crs object detected; please recreate object with a recent sf::st_crs()</span></span>
<span><span class="co">## old-style crs object detected; please recreate object with a recent sf::st_crs()</span></span>
<span><span class="co">## old-style crs object detected; please recreate object with a recent sf::st_crs()</span></span>
<span><span class="co">## old-style crs object detected; please recreate object with a recent sf::st_crs()</span></span>
<span><span class="co">## old-style crs object detected; please recreate object with a recent sf::st_crs()</span></span>
<span><span class="co">## old-style crs object detected; please recreate object with a recent sf::st_crs()</span></span></code></pre>
<div class="figure" style="text-align: center">
<img src="MultiStrataVignette_files/figure-html/seg_design5-1.png" alt="Figure 10: Coverage scores plotted only for the southern stratum" width="432"><p class="caption">
Figure 10: Coverage scores plotted only for the southern stratum
</p>
</div>
</div>
<div class="section level3">
<h3 id="point-transect-design">Point transect design<a class="anchor" aria-label="anchor" href="#point-transect-design"></a>
</h3>
<p>For this point transect example we will use a different study region.
This is an area of forest in Scotland between Dundee and St Andrews made
up of two strata, Figure 11. As this region is not projected we will
first need to project the study area onto a flat plane.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Load the unprojected shapefile</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Linking to GEOS 3.12.1, GDAL 3.8.4, PROJ 9.3.1; sf_use_s2() is TRUE</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">shapefile.name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"TentsmuirUnproj.shp"</span>, package <span class="op">=</span> <span class="st">"dssd"</span><span class="op">)</span></span>
<span><span class="va">sf.shape</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">read_sf</a></span><span class="op">(</span><span class="va">shapefile.name</span><span class="op">)</span></span>
<span><span class="co"># Define a European Albers Equal Area projection</span></span>
<span><span class="va">proj4string</span> <span class="op">&lt;-</span> <span class="st">"+proj=aea +lat_1=56 +lat_2=62 +lat_0=50 +lon_0=-3 +x_0=0 </span></span>
<span><span class="st">                +y_0=0 +ellps=intl +units=m"</span></span>
<span><span class="co"># Project the study area on to a flat plane</span></span>
<span><span class="va">projected.shape</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">sf.shape</span>, crs <span class="op">=</span> <span class="va">proj4string</span><span class="op">)</span></span>
<span><span class="co"># Create the survey region in dssd</span></span>
<span><span class="va">region.tm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make.region.html">make.region</a></span><span class="op">(</span>region.name <span class="op">=</span> <span class="st">"Tentsmuir"</span>,</span>
<span>                         strata.name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Main Area"</span>, <span class="st">"Morton Lochs"</span><span class="op">)</span>,</span>
<span>                         shape <span class="op">=</span> <span class="va">projected.shape</span><span class="op">)</span></span>
<span><span class="co"># Plot the survey region</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">region.tm</span>, legend.params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>inset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.3</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: legend.params argument is deprecated since version 0.2.3</span></span></code></pre>
<div class="figure" style="text-align: center">
<img src="MultiStrataVignette_files/figure-html/point_region-1.png" alt="Figure 11: Study region depicting an area of forest between Dundee and St Andrews in Scotland. It comprises of a main stratum and a Morton Loch stratum which forms part of a nature reserve in the area." width="576"><p class="caption">
Figure 11: Study region depicting an area of forest between Dundee and
St Andrews in Scotland. It comprises of a main stratum and a Morton Loch
stratum which forms part of a nature reserve in the area.
</p>
</div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Create a coverage grid</span></span>
<span><span class="va">cover.tm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make.coverage.html">make.coverage</a></span><span class="op">(</span><span class="va">region.tm</span>, n.grid.points <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span></code></pre></div>
<p>Point transect designs and point transect design parameters can be
varied across strata in the same way as line transect designs. Here we
use a systematic grid of point in both the main and Morton Lochs strata.
We specify that there should be approximately 80 samplers across both
strata and that we would like 25% of the effort allocated to the Morton
Lochs strata and 75% to the main strata. As the Morton Lochs strata is
such a small area it could be prone to edge effects so we will use a
plus sampling strategy. Figure 12 shows one possible realisation of this
design.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">design.tm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make.design.html">make.design</a></span><span class="op">(</span>region <span class="op">=</span> <span class="va">region.tm</span>,</span>
<span>                      transect.type <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>                      design <span class="op">=</span> <span class="st">"systematic"</span>,</span>
<span>                      samplers <span class="op">=</span> <span class="fl">80</span>,</span>
<span>                      effort.allocation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.75</span>,<span class="fl">0.25</span><span class="op">)</span>, </span>
<span>                      edge.protocol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"minus"</span>,<span class="st">"plus"</span><span class="op">)</span>,</span>
<span>                      truncation <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                      coverage.grid <span class="op">=</span> <span class="va">cover.tm</span><span class="op">)</span></span>
<span><span class="va">transects.tm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate.transects-methods.html">generate.transects</a></span><span class="op">(</span><span class="va">design.tm</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">region.tm</span>, <span class="va">transects.tm</span>, lwd <span class="op">=</span> <span class="fl">0.8</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="MultiStrataVignette_files/figure-html/point_eg-1.png" alt="Figure 12: An example multi strata point transect survey." width="576"><p class="caption">
Figure 12: An example multi strata point transect survey.
</p>
</div>
<p>We can also have a look at the statistics for this particular survey.
The output below shows that although we set the effort to be 80 samplers
in total we have 92. While we see the expected number in the main
stratum 75% of 80 is 60 samplers, we see more than expected in the
Morton Lochs stratum, 32 rather than 20. This is down to the fact that
we are using a plus sampling edge protocol in this stratum and if we
check in Figure 12 above we will see that approximately 20 points
actually fall inside the Morton Lochs stratum. This additional effort
that is required for the plus sampling strategy is something to be aware
of when costing for your survey.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">transects.tm</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##    Strata Main Area:</span></span>
<span><span class="co">##    __________________</span></span>
<span><span class="co">## Design:  systematically spaced transects</span></span>
<span><span class="co">## Spacing:  484.9165</span></span>
<span><span class="co">## Number of samplers:  60</span></span>
<span><span class="co">## Design angle:  0</span></span>
<span><span class="co">## Edge protocol:  minus</span></span>
<span><span class="co">## Covered area:  1842894</span></span>
<span><span class="co">## Strata coverage: 13.06%</span></span>
<span><span class="co">## Strata area:  14108643</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    Strata Morton Lochs:</span></span>
<span><span class="co">##    _____________________</span></span>
<span><span class="co">## Design:  systematically spaced transects</span></span>
<span><span class="co">## Spacing:  189.1117</span></span>
<span><span class="co">## Number of samplers:  32</span></span>
<span><span class="co">## Design angle:  0</span></span>
<span><span class="co">## Edge protocol:  plus</span></span>
<span><span class="co">## Covered area:  630454.5</span></span>
<span><span class="co">## Strata coverage: 88.14%</span></span>
<span><span class="co">## Strata area:  715264.9</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    Study Area Totals:</span></span>
<span><span class="co">##    _________________</span></span>
<span><span class="co">## Number of samplers:  92</span></span>
<span><span class="co">## Effort allocation: 75%, 25%</span></span>
<span><span class="co">## Covered area:  2473348</span></span>
<span><span class="co">## Average coverage: 16.68%</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="appendices">Appendices<a class="anchor" aria-label="anchor" href="#appendices"></a>
</h2>
<div class="section level3">
<h3 id="a--manual-creation-of-multiple-strata-study-areas">A. Manual creation of multiple strata study areas<a class="anchor" aria-label="anchor" href="#a--manual-creation-of-multiple-strata-study-areas"></a>
</h3>
<p>Example of creating a study region manually. This example code is
taken from the help file for â€˜sf::st_multipolygonâ€™. To create an sf
polygon or multipolygon, create one or more matrices of coordinates
representing the outer polygons and any holes. For multipolygons the
outer polygons and holes are defined by their placement within their
list element, only the first matrix in a list element is an outer
polygon then all the following matrices are holes. In the following
example all polygons would be considered to be in the same strata.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outer</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">15</span>,<span class="fl">0</span>,<span class="fl">15</span>,<span class="fl">10</span>,<span class="fl">0</span>,<span class="fl">10</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">2</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">hole1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">2</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">hole2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">6</span>,<span class="fl">8</span>,<span class="fl">5.5</span>,<span class="fl">7</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">2</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">pol1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">outer</span>, <span class="va">hole1</span><span class="op">*</span><span class="fl">1.5</span>, <span class="va">hole2</span><span class="op">)</span></span>
<span><span class="va">pol2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">outer</span> <span class="op">+</span> <span class="fl">15</span>, <span class="va">hole2</span><span class="op">*</span><span class="fl">1.5</span> <span class="op">+</span> <span class="fl">12</span><span class="op">)</span></span>
<span><span class="va">pol3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">outer</span> <span class="op">+</span> <span class="fl">30</span>, <span class="va">hole2</span><span class="op">*</span><span class="fl">2.5</span> <span class="op">+</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="va">mp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">pol1</span>,<span class="va">pol2</span>,<span class="va">pol3</span><span class="op">)</span></span>
<span><span class="va">mp1</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html" class="external-link">st_multipolygon</a></span><span class="op">(</span><span class="va">mp</span><span class="op">)</span></span>
<span></span>
<span><span class="va">region</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make.region.html">make.region</a></span><span class="op">(</span>region.name <span class="op">=</span> <span class="st">"study.area"</span>, shape <span class="op">=</span> <span class="va">mp1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">region</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="MultiStrataVignette_files/figure-html/makeown-1.png" alt="Figure 13: A single study region with multiple polygon parts." width="576"><p class="caption">
Figure 13: A single study region with multiple polygon parts.
</p>
</div>
<p>If instead you wanted to create the 3 separate polygons as 3 distinct
strata you could use the following code:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outer</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">15</span>,<span class="fl">0</span>,<span class="fl">15</span>,<span class="fl">10</span>,<span class="fl">0</span>,<span class="fl">10</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">2</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">hole1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">2</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">hole2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">6</span>,<span class="fl">8</span>,<span class="fl">5.5</span>,<span class="fl">7</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">2</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">pol1</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html" class="external-link">st_polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">outer</span>, <span class="va">hole1</span><span class="op">*</span><span class="fl">1.5</span>, <span class="va">hole2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pol2</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html" class="external-link">st_polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">outer</span> <span class="op">+</span> <span class="fl">15</span>, <span class="va">hole2</span><span class="op">*</span><span class="fl">1.5</span> <span class="op">+</span> <span class="fl">12</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pol3</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html" class="external-link">st_polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">outer</span> <span class="op">+</span> <span class="fl">30</span>, <span class="va">hole2</span><span class="op">*</span><span class="fl">2.5</span> <span class="op">+</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sfc</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/sfc.html" class="external-link">st_sfc</a></span><span class="op">(</span><span class="va">pol1</span>,<span class="va">pol2</span>,<span class="va">pol3</span><span class="op">)</span></span>
<span><span class="va">strata.names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SW"</span>, <span class="st">"central"</span>, <span class="st">"NE"</span><span class="op">)</span></span>
<span><span class="va">mp1</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">st_sf</a></span><span class="op">(</span>strata <span class="op">=</span> <span class="va">strata.names</span>, geom <span class="op">=</span> <span class="va">sfc</span><span class="op">)</span></span>
<span></span>
<span><span class="va">region</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make.region.html">make.region</a></span><span class="op">(</span>region.name <span class="op">=</span> <span class="st">"study.area"</span>, </span>
<span>                      strata.name <span class="op">=</span> <span class="va">strata.names</span>, </span>
<span>                      shape <span class="op">=</span> <span class="va">mp1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">region</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="MultiStrataVignette_files/figure-html/makeown2-1.png" alt="Figure 14: A single study region with multiple polygon parts.  Each are separate strata." width="576"><p class="caption">
Figure 14: A single study region with multiple polygon parts. Each are
separate strata.
</p>
</div>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="bibliography">Bibliography<a class="anchor" aria-label="anchor" href="#bibliography"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-dssd-pkg" class="csl-entry">
Marshall, L. 2019. <em>Dssd: Distance Sampling Survey Design</em>. <a href="https://CRAN.R-project.org/package=dssd" class="external-link">https://CRAN.R-project.org/package=dssd</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>We improve our site and software support by using Microsoft Clarity to see <br> how you use our website. By using our site, you agree that we and Microsoft <br> can collect and use this data. Clarity is GDPR compliant.</p>
</div>

<div class="pkgdown-footer-right">
  <p>If you wish to donate to development and maintenance</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
